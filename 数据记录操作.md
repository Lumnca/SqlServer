# ------------------ SqlServer数据记录操作 ------------------- #

<p id="title"></p>

## 目录 ##

:arrow_down:<a href="#a1">1.管理工具进行数据操作</a>

:arrow_down:<a href="#a2">2.使用T-SQl语句进行数据操作</a>

:arrow_down:<a href="#a3">3.数据表数据修改</a>


<p id="a1"></p>

## :mortar_board: 管理工具进行数据操作 ##

:arrow_double_up:<a href = "#title">返回目录</a>

使用管理者工具图形界面可以很方便进行数据操作，下面介绍这些方法。

* 查看表数据（右击表 -> 选择前1000行 ）：

![](https://github.com/Lumnca/StudySqlServer/blob/master/Image/a18.png)

上侧视图显示的是查询的代码，这是由于你点击了查询表，工具帮你自动生成的查询表语句代码，你也可以复制这段代码，进行代码语句查询，在下侧的视图里显示了表的数据，当然由于我们没有插入数据，所以暂时没有数据。接下来我们来插入数据

* 插入表数据（右击表 -> 编辑前200行）：

![](https://github.com/Lumnca/StudySqlServer/blob/master/Image/a19.png)

注意如果使用了标识与默认值的字段如果你不想破坏默认值以及自动增量，你只需要跳过这个字段就行，在你编写下一行的时候，会帮你自动生成。
注意数据要和你设定的数据类型一致，否则会出现报错，说你类型或者条件不匹配。出现红色的感叹号是因为你插入了数据使得表的数据结构变化，这个没什么影响，点击下一行最前面的 `*` 号即可完成本行操作。最后Ctrl + S 保存退出


* 修改数据

这个就比较简单了，在选择编辑前200行的模式了里你只需要选中某行某个数据点击即可修改。如果想删除某个数据右击行数据就有删除，这里就不做演示了，可以自己尝试。

<p id="a2"></p>

## :mortar_board: 使用T-SQl语句进行数据操作 ##

:arrow_double_up:<a href = "#title">返回目录</a>

我们重点还是在学习T-SQl语句上来进行数据操作。下面介绍语句修改,我所使用的表结构如下 ：

![](https://github.com/Lumnca/StudySqlServer/blob/master/Image/a20.png)

* 插入语句Insert

**示例一（简单插入语句）**

```sql
INSERT Student VALUES ('蒋星','201604',2016,20)
```

这种插入语法为全插入，我的表总共有4个字段数据，也就是说尽管你设定了默认值，但还是要你输入这些字段的数据，还有一点就是要类型匹配，我们的ID列尽管全是数字，但它是varhcar类型，所以还是要给该数据加上引号。一定注意字符型要加引号。还有就是插入的数据要与表字段一一对应，即第一个数据对应Name，第二个对应ID，依次下去，不能错序插入。

**示例二（部分插入语句）**

```sql
INSERT INTO Student(Name,ID,Age) VALUES ('刘七','201703',20)
```

因为我们的Groups列含有默认值，当我们想使用默认值不行进行修改值的时候，就可以使用部分插入语句，不同的是他需要声明 INTO 表名（添加字段1，添加字段2，......）也就是需要自己声明要添加的字段数据列，然后在一一对应插入数据，当然对应是与前面括号中的字段数据一一匹配，而不是与表的字段去做匹配。

**示例三（插入值少于字段记录）**

```sql
INSERT INTO Student(Name,ID) VALUES (N'张三',N'201704')
```

这其实与示例二一模一样，不一样的是他没有完整的插入数据，因为我们的Age支持空值，所以我们可以不插入这个数据，这里数据前面加了一个N，它其是并没都太大的影响，加上 N 代表存入数据库时以 Unicode 格式存储。N 'string' 表示string是个Unicode字符串。这个东西大家随意，可以百度去查它具体的运用，在平时的运用中，这个影响不会太大。

**示例四（在标识列字段中插入内容）**

我们新设置一个具有标识量的列 Num 从1开始递增

```sql
SET IDENTITY_INSERT Student ON;

GO

INSERT INTO Student(Name,ID,Num)VALUES ('李四','201704',99)
```

在默认情况下INSERT语句不能对具有标识列数据进行修改，如果想要对具有标识列的数据进行修改，则第一步是要修改表允许修改标识段的值。即
`SET IDENTITY_INSERT 表名 ON;`这样就可以对标识列进行修改。值得注意的是，在下次的数据插入中，你必须要对这个标识列进行初始化，也就是说你一旦声明了可修改，那么下面的标识列数据需要你去定义，不能按照规则标识增量而改变。当然你想变回原来的样子只需要关掉修改即可：

```sql
SET IDENTITY_INSERT Student OFF;

INSERT INTO Student(Name,ID)VALUES ('李四','201705')
```

这样就可以使用标识自动修改。

**示例五（将查询的结果插入到另外一个表）**

![](https://github.com/Lumnca/StudySqlServer/blob/master/Image/a21.png)

把上面的学生名字和ID还有成绩取出来插入到另一个表：

```sql
CREATE TABLE StudentScore(
	Name varchar(50) NOT NULL,
	ID varchar(50) PRIMARY KEY,
	Score Int NOT NULL
)

GO

INSERT INTO StudentScore 

SELECT Name ,ID ,Score FROM Student;
```

第一步是创建一个你要存入的表，第二步是使用INSERT语句插入，第三步是使用SELECT查询语句进行数据选取。值得注意的是要插入数据字段类型与大小都要与原来的类型一样。如果只想插入几条信息可以使用Top限制插入个数：

```SQL
DELETE StudentScore 

GO

INSERT TOP(3) INTO StudentScore 
SELECT Name ,ID ,Score FROM Student;
```

DELETE StudentScore 即为删除数据，TOP（3） 保留前3行数据。

**示例六（将查询的数据插入到另外一个表并对某一字段赋值）**

现在我们对成绩表增加一个新的字段Pass代表成绩是否合格，在插入到这个表的时候想给Pass字段全赋值为及格：

```SQL
DELETE StudentScore 

GO

INSERT StudentScore(Name,ID,Score,Pass)

SELECT Name ,ID ,Score,'及格' FROM Student;
```

![](https://github.com/Lumnca/StudySqlServer/blob/master/a22.png)


* 更新语句Update

**示例一（简单的更新语句）**

```sql
UPDATE StudentScore 
SET Score=Score*1.2
WHERE Name = '小亮'
```

上面的操作把小亮的成绩修改了原来的1.2倍，首先是声明更新语句 `UPDATE + 表名`,第二是声明修改数据 `SET + 表达式 `,第三是说明修改的数据
的来源 `WHERE + 条件`。注意的是WHER 的条件不用 == ，在SQL更新语句中，使用 = 即可代表相等。UPDATE 可以一次修改多条记录，所以需要WHERE更好的定位修改。如果没有WHERE 则会指定全部数据修改。

**示例二（修改整列）**

```sql
UPDATE StudentScore 
SET Score=Score*0.9
```
如上所说不需要加WHERE即可对全部进行修改。

**示例三（使用其他表的数据进行修改）**

```SQL
UPDATE StudentScore 
SET Score = Student.Score + Student.Age
FROM Student
WHERE Student.Name = StudentScore.Name
```
在使用其他的表字段的时候要使用圆点来取属性，因为两个表可能都有相同的字段名，所以加上表这样就能区分不同的字段。`SET Score = Student.Score + Student.Age` 代表成绩为学生表的成绩+学生的年龄，`FROM Student` 声明 要使用的表。最主要的是理解这句话
`WHERE Student.Name = StudentScore.Name` 没有这句话工具就不知道要修改什么值，会把数据改成一样的，其实使用其他表数据来修改都要这安阳的形式：即找到有个字段两个表都含有来代表表的连通，这样才能确保每条修改的数据都是来自于表的同一行。

**示例三（使用TOP语句）**

前面所说的TOP可以限制出现个数，这里还可以使用百分数。比如只想前50%的数据：

```SQL
UPDATE TOP(50) PERCENT StudentScore 
SET Score = Student.Score + Student.Age
FROM Student
WHERE Student.Name = StudentScore.Name
```
`TOP(50) PERCENT`代表修改50%的数据，没有PERCENT则是修改前50条数据。TOP一般写在 UPDATE 语句后面，表名之前。

* 删除语句DELETE

**示例一（简单删除语句）**

```sql
DELETE StudentScore WHERE Name = '小亮'
```

删除姓名为小亮的数据

**示例二（删除多条语句）**

```sql
DELETE StudentScore WHERE Score < 550
```

删除姓名分数小于550的信息

**示例三（引用其他表的数据来删除）**

```sql
DELETE StudentScore 
FROM Student
WHERE (Student.Name = StudentScore.Name)
```
**示例四（删除表中所有数据）**

```sql
DELETE StudentScore 
```

删除数据还可以使用TRUNCATE TABLE 相当于 DELETE 表名

* 查询数据SELECT

**示例一（查询所有数据）**

```sql
SELECT * FROM Student
```

`SELECT * FROM 表名` `*` 代表全部。

**示例二（查询某些字段）**

```sql
SELECT Name,ID,Score FROM Student
```

只查询Name,ID,Score 三个字段的表信息。

**示例三（为查询数据添加计算）**

对分数换算到100分以内，即分数/750再乘以100
```sql
SELECT Name,ID,Score*100/750 FROM Student
```

为了区别Score，我们可以使用AS来给这个字段取个新命名：NewScore

```sql
SELECT Name,ID,Score*100/750 AS NewScore FROM Student
```

这样你就可以看到这个字段名为NewScore

**示例三（查看最前面的记录）**

```sql
SELECT TOP(2) * FROM Student
```

查看两条记录TOP(2) 也可以写成 TOP 2，如前面所说如果是百分数可以加一个 PERCENT 

```sql
SELECT TOP(50) PERCENT  * FROM Student
```

查看50%的数据

**示例四（带有排序的查询）**

```SQL
SELECT   * FROM Student ORDER BY Score DESC
```
降序排序

```sql
SELECT   * FROM Student ORDER BY Score ASC
```
升序排序

注意的是排序语句一般都写在所有语句最后面，也就是说这个是在所有排序的最后面在声明。

**示例五（查看不重复的数据）**

```sql
SELECT  DISTINCT Groups FROM Student 
```

 DISTINCT不允许重复



